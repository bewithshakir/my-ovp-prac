{"version":3,"sources":["ovpApp/watch-later/watch-later.js"],"names":[],"mappings":"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","file":"ovpApp/watch-later/watch-later.js","sourcesContent":["(function () {\n    'use strict';\n\n    angular.module('ovpApp.watchlater', [\n        'ovpApp.messages',\n        'ovpApp.directives.carousel',\n        'ovpApp.directives.product',\n        'ovpApp.services.nns',\n        'ovpApp.services.bookmark',\n        'ovpApp.watchlater.data',\n        'ovpApp.watchlater.router',\n        'ovpApp.services.homePage',\n        'ovpApp.services.locationService',\n        'ui.router',\n        'ovpApp.services.parentalControlsService',\n        'ovpApp.components.alert',\n        'ovpApp.components.ovp.clickConfirm',\n        'ovpApp.services.errorCodes'\n    ])\n    .component('myLibrary', {\n        templateUrl: '/js/ovpApp/watch-later/watch-later.html',\n        controller: class WatchLaterPage {\n            /* @ngInject */\n            constructor($scope, BookmarkService, $rootScope, $controller, locationService,\n                watchLaterData, $window, $log, $q, $timeout, alert, messages, $state, errorCodesService) {\n\n                angular.extend(this, {$scope, BookmarkService, $rootScope, $controller, locationService,\n                    watchLaterData, $window, $log, $q, $timeout, alert, messages, $state, errorCodesService});\n            }\n\n\n            $onInit() {\n                this.alert = '';\n\n                this.initOOH();\n\n                this.initCategories();\n            }\n\n            getItems(category) {\n                if (category.context !== 'inProgress') {\n                    return category.media;\n                } else {\n                    let filtered = category.media.filter(asset => !this.isUnrentedTvodAsset(asset));\n\n                    // Need to return a saved copy in order to prevent infinite digest\n                    if (!this.filteredInProgressItems || this.filteredInProgressItems.length != filtered.length) {\n                        this.filteredInProgressItems = filtered;\n                    }\n                    return this.filteredInProgressItems;\n                }\n            }\n\n            hasNoContent() {\n                return this.categories && (this.categories.length === 0 ||\n                    this.categories.reduce((val, category) => val + category.media.length, 0) === 0);\n            }\n\n            //////////////////////\n\n            isUnrentedTvodAsset(asset) {\n                return !asset.isSeries && asset.streamList &&\n                    asset.streamList.every(this.isUnrentedTvodStream);\n            }\n\n            isUnrentedTvodStream(stream) {\n                return stream.type === 'ONLINE_ONDEMAND' &&\n                    stream.streamProperties.price > 0 &&\n                    !stream.streamProperties.tvodEntitlement;\n            }\n\n            initOOH() {\n                this.locationService.getLocation().then((location) => {\n                    this.ooh = !location.behindOwnModem;\n                });\n\n                this.$scope.$on('LocationService:locationChanged', (event, location) => {\n                    this.ooh = !location.behindOwnModem;\n                });\n            }\n\n            initCategories() {\n                let promise = this.watchLaterData.getCategories()\n                    .then(\n                        categories => {\n                            this.categories = this.augmentCategories(categories);\n                            this.$rootScope.$broadcast('pageChangeComplete', this.$state.current);\n                        },\n                        () => {\n                            this.categories = [];\n                            this.alert.open({\n                                message: this.errorCodesService.getMessageForCode('WGE-1001')\n                            });\n\n\n                        }\n                    );\n\n                this.$timeout(() => this.$rootScope.$broadcast(\n                    'message:loading',\n                    promise,\n                    undefined,\n                    'My Library'\n                ));\n            }\n\n            augmentCategories(categories) {\n                return categories.map(c => {\n                    if (c.context == 'inProgress') {\n                        c.enableRemove = true;\n                        c.onRemove = (asset) => {\n                            this.BookmarkService.deleteFromInProgressList(asset).catch(() => {\n                                this.$rootScope.$broadcast('message:growl',\n                                    this.errorCodesService.getMessageForCode('WWL-1001'));\n                            });\n                        };\n                        c.onClear = this.BookmarkService.clearInProgressList;\n                        c.enableOOW = true;\n                    } else if (c.context == 'saved') {\n                        c.enableRemove = true;\n                        c.onRemove = (asset) => {\n                            this.BookmarkService.deleteFromWatchLater(asset).catch(() => {\n                                this.$rootScope.$broadcast('message:growl',\n                                    this.errorCodesService.getMessageForCode('WWL-1001', {\n                                    TITLE: asset.title\n                                }));\n                            });\n                        };\n                        c.onClear = this.BookmarkService.clearWatchLater;\n                        c.enableOOW = true;\n                    } else if (c.context == 'rented') {\n                        c.enableRemove = false;\n                        c.enableOOW = true;\n                    }\n\n                    return c;\n                });\n            }\n        }\n    });\n}());\n"],"sourceRoot":"/source/"}