{"version":3,"sources":["ovpApp/services/stb-parental-pin-factory.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,eAAe,CAAC,YAAY,EAAE,SAAS,iBAAiB,QAAQ,OAAO,EAAE,KAAK,IAAI,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK,EAAE,IAAI,aAAa,MAAM,IAAI,WAAW,aAAa,WAAW,cAAc,OAAO,WAAW,eAAe,MAAM,IAAI,WAAW,YAAY,WAAW,WAAW,MAAM,OAAO,eAAe,QAAQ,WAAW,KAAK,iBAAiB,OAAO,UAAU,aAAa,YAAY,aAAa,EAAE,IAAI,YAAY,iBAAiB,YAAY,WAAW,aAAa,IAAI,aAAa,iBAAiB,aAAa,cAAc,OAAO;;AAEjiB,SAAS,gBAAgB,UAAU,aAAa,EAAE,IAAI,EAAE,oBAAoB,cAAc,EAAE,MAAM,IAAI,UAAU;;AAJhH,CAAC,YAAY;IACT;;;IAEA,QAAQ,OAAO,4BAA4B,CACvC,sCACA,4CAEH,QAAQ,mBAAmB;;;IAG5B,SAAS,gBAAgB,oBAAoB,IAAI,yBAAyB;;;;;;QAQtE,IAHM,WAAQ,CAAA,YAAA;YACC,SADT,SACU,KAAK;gBAIb,gBAAgB,MALlB;;gBAEE,KAAK,MAAM;;;;;YAUf,aAZE,UAAQ,CAAA;gBAaN,KAAK;gBACL,OARY,SAAA,mBAAG;oBACf,OAAO,wBAAwB;;;;eAYhC;gBACC,KAAK;gBACL,OAVO,SAAA,YAAC,KAAK;oBACb,OAAO,mBAAmB,UAAU,KAAK,KAAK,KAAK,UAAA,QAAU;wBACzD,IAAI,OAAO,uBAAuB,KAAK;4BACnC,OAAO;+BACJ;4BACH,OAAO,GAAG,OAAO;;;;;;;;;;eAoB1B;gBACC,KAAK;gBACL,OAZa,SAAA,oBAAG;oBAChB,OAAO,GAAG,QAAQ;;;;eAgBnB;gBACC,KAAK;gBACL,OAdE,SAAA,OAAC,qBAAqB;oBAepB,IAAI,QAAQ;;;oBAbhB,OAAO,mBAAmB,UAAU,KAAK,KAAK,KAAK,UAAA,QAAU;wBACzD,IAAI,UAAU;4BACV,oBAAoB;4BACpB,cAAc,OAAO;;wBAEzB,OAAO,cAAc;wBACrB,mBAAmB,UAAU,MAAK,KAAK;;;;;eAqB5C;gBACC,KAAK;gBACL,OAlBI,SAAA,WAAG;oBACP,OAAO,mBAAmB,UAAU,KAAK,KAAK,KAAK,UAAA,QAAU;wBACzD,OAAQ,OAAO,qBAAsB,OAAO;;;;;YAuBpD,OArEE;;;QAmDN,OAAO;YACH,QAAQ,SAAA,OAAU,KAAK;gBACnB,OAAO,IAAI,SAAS;;;;KAI/B","file":"ovpApp/services/stb-parental-pin-factory.js","sourcesContent":["(function () {\n    'use strict';\n\n    angular.module('ovpApp.services.stbPCPin', [\n        'ovpApp.services.stbSettingsService',\n        'ovpApp.services.parentalControlsService'\n    ])\n    .factory('StbPCPinFactory', StbPCPinFactory);\n\n    /* ngInject */\n    function StbPCPinFactory(StbSettingsService, $q, parentalControlsService) {\n\n        /**\n         * Captures the stb and allowing the pin-dialogs to use the set top box defined at navigation.\n         */\n        class StbPCPin {\n            constructor(stb) {\n                this.stb = stb;\n            }\n\n            /* pinService interface */\n            isPrimaryAccount() {\n                return parentalControlsService.isPrimaryAccount();\n            }\n\n            /* pinService interface */\n            validatePIN(pin) {\n                return StbSettingsService.getDevice(this.stb).then(device => {\n                    if (device.parentalControlPIN === pin) {\n                        return true;\n                    } else {\n                        return $q.reject('Invalid pin');\n                    }\n                });\n            }\n\n            /**\n             * pinService interface - used by pin-entry.js\n             *\n             * The should always return false since it has no meaning in this context\n             */\n            shouldSetDefaults() {\n                return $q.resolve(false);\n            }\n\n            /* pinService interface */\n            setPIN(pin /*, password */) {\n                // TODO Use password if this is not the primary account\n                return StbSettingsService.getDevice(this.stb).then(device => {\n                    var devData = {\n                        parentalControlPIN: pin,\n                        strTimestamp: device.strTimestamp\n                    };\n                    device.purchasePIN = pin;\n                    StbSettingsService.setDevice(this.stb, devData);\n                });\n            }\n\n            /* used as pinService */\n            isPINSet() {\n                return StbSettingsService.getDevice(this.stb).then(device => {\n                    return (device.parentalControlPIN) ? true : false;\n                });\n            }\n        }\n\n        return {\n            create: function (stb) {\n                return new StbPCPin(stb);\n            }\n        };\n    }\n}());\n"],"sourceRoot":"/source/"}