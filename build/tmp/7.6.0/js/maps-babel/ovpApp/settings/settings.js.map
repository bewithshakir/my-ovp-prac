{"version":3,"sources":["ovpApp/settings/settings.js"],"names":[],"mappings":"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","file":"ovpApp/settings/settings.js","sourcesContent":["\n(function () {\n    'use strict';\n    angular.module('ovpApp.settings', [\n        'ovpApp.settings.router'\n        ])\n\n    .component('settingsMainPage', {\n        templateUrl: '/js/ovpApp/settings/settings.html',\n        bindings: {\n            stb: '<'\n        },\n        controller: class SettingsController {\n            /* @ngInject */\n            constructor($state, $timeout, settingsStateService, config,\n                $document, stbService) {\n\n                angular.extend(this, {$state, $timeout, settingsStateService,\n                    config, $document, stbService});\n            }\n\n            $onInit() {\n                this.menuItems = [];\n                this.stbCategory = this.config.stbSettings;\n\n                this.menuItemsPromise = this.settingsStateService.getStates().then(states => {\n                    this.menuItems = states;\n                    this.$doCheck();\n                });\n\n                this.stbObserver = this.stbService.currentStbSource\n                    .do(stb => this.stb = stb) // Save a reference to the set top box every time, including the first\n                    .skip(1) // Skip the first to keep from entering a reload loop\n                    .subscribe(() => {\n                        if (this.$state.current.name.indexOf('ovp.settings.stb') === 0) {\n                            this.$state.reload('ovp.settings.stb');\n                        }\n                    });\n            }\n\n            $doCheck() {\n                const menuStates = this.menuItems.map(m => m.enabled());\n                if (!angular.equals(this.oldMenuStates, menuStates)) {\n                    this.handleMenuChange();\n                    this.oldMenuStates = menuStates;\n                }\n            }\n\n            $onDestroy() {\n                this.stbObserver.dispose();\n            }\n\n            menuItemFocussed(menuItem) {\n                this.goTo(menuItem, {location: 'replace'});\n            }\n\n            menuItemMouseDownHandler(menuItem, $event) {\n                if (this.isLeftMouseButton($event)) {\n                    this.goTo(menuItem);\n                }\n            }\n\n            isLeftMouseButton(event) {\n                if ('buttons' in event) {\n                    return event.buttons == 1;\n                }\n                const button = event.which || event.button;\n                return button == 1;\n            }\n\n            goTo(menuItem, options) {\n                const alreadyThere = this.$state.current.name === menuItem.state;\n                const goingThere = this.$state.transition && this.$state.transition.to().name === menuItem.state;\n                if (!alreadyThere && !goingThere) {\n                    this.$state.go(menuItem.state, {}, options);\n                }\n            }\n\n            handleMenuChange() {\n                this.menuCategory = [];\n                this.menuItems.forEach((menu) => {\n                    if (menu.enabled()) {\n                        if (menu.type === this.config.globalSettings &&\n                            this.menuCategory.indexOf(this.config.globalSettings) === -1) {\n                            this.menuCategory.push(this.config.globalSettings);\n                        } else if (menu.type === this.config.websiteSettings &&\n                            this.menuCategory.indexOf(this.config.websiteSettings) === -1) {\n                            this.menuCategory.push(this.config.websiteSettings);\n                        } else if (menu.type === this.config.stbSettings &&\n                            this.menuCategory.indexOf(this.config.stbSettings) === -1) {\n                            this.menuCategory.push(this.config.stbSettings);\n                        }\n                    }\n                });\n            }\n\n            onClick($event) {\n                //Firefox doesn't recognize, `event.keyCode` correctly so adding `event.which` check.\n                if ($event.keyCode === 32 || $event.which === 32) {\n                    $event.preventDefault();\n                }\n            }\n\n            onKeyDown($event) {\n                let keys = {left: 37, up: 38, right: 39, down: 40, tab: 9, enter: 13},\n                    activeLiElement = angular.element(this.$document[0].activeElement).parent(),\n                    activeLiParentElement = activeLiElement.parent(),\n                    parentElementAnchors;\n\n                if ($event.keyCode === keys.down || $event.keyCode === keys.right) {\n                    if (!activeLiElement.next().hasClass('list-item')) {\n                        parentElementAnchors = activeLiParentElement.next().find('a')[0];\n                        if (parentElementAnchors) {\n                            parentElementAnchors.focus();\n                        }\n                    } else {\n                        activeLiElement.next().find('a').focus();\n                    }\n                    $event.preventDefault();\n                } else if ($event.keyCode === keys.up || $event.keyCode === keys.left) {\n                    if (!activeLiElement.prev().hasClass('list-item')) {\n                        parentElementAnchors = activeLiParentElement.prev().find('a');\n                        if (parentElementAnchors && parentElementAnchors.length > 0) {\n                            parentElementAnchors[parentElementAnchors.length - 1].focus();\n                        }\n                    } else {\n                        activeLiElement.prev().find('a').focus();\n                    }\n                    $event.preventDefault();\n                } else if ($event.keyCode === keys.enter) {\n                    this.$timeout(function () {\n                        // This will work since we assign tabIndex as 0 to the first\n                        // focussable form field of tabPanel.\n                        // When accessing the setting using a deep-link we need to set focus asynchronously\n                        // otherwise focus gets lost. So putting this in a $timeout.\n                        this.$document.find('.settings-tabpanel').find('[tabindex = 0]')[0].focus();\n                    }.bind(this), 0);\n                    $event.preventDefault();\n                }\n            }\n\n            setAriaControls(category, menu) {\n                return 'panel' + (this.menuCategory.indexOf(category) + this.menuItems.indexOf(menu) + 1);\n            }\n\n            exit(event) {\n                //Handling Esc/Ctrl+up/left/Shift+tab Event\n                const keys = {\n                    left: 37,\n                    up: 38,\n                    esc: 27,\n                    tab: 9\n                };\n                if (event.keyCode === keys.esc || (event.ctrlKey &&\n                   (event.keyCode === keys.up || event.keyCode === keys.left))) {\n                    angular.element('.sidebar-nav-settings li a.active').focus();\n                }\n            }\n        }\n    });\n}());\n"],"sourceRoot":"/source/"}