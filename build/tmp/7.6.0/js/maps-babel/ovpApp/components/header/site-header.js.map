{"version":3,"sources":["ovpApp/components/header/site-header.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,eAAe,CAAC,YAAY,EAAE,SAAS,iBAAiB,QAAQ,OAAO,EAAE,KAAK,IAAI,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK,EAAE,IAAI,aAAa,MAAM,IAAI,WAAW,aAAa,WAAW,cAAc,OAAO,WAAW,eAAe,MAAM,IAAI,WAAW,YAAY,WAAW,WAAW,MAAM,OAAO,eAAe,QAAQ,WAAW,KAAK,iBAAiB,OAAO,UAAU,aAAa,YAAY,aAAa,EAAE,IAAI,YAAY,iBAAiB,YAAY,WAAW,aAAa,IAAI,aAAa,iBAAiB,aAAa,cAAc,OAAO;;AAEjiB,SAAS,gBAAgB,UAAU,aAAa,EAAE,IAAI,EAAE,oBAAoB,cAAc,EAAE,MAAM,IAAI,UAAU;;AAJhH,CAAC,YAAM;IACH;;;IAEA,QAAQ,OAAO,4BAA4B,CACvC,oCACA,iCACA,qCACA,yBACA,kCACA,wCACA,mBACA,0BACA,uBACA,4BACA,8BACA,8BACA,gBACA,aACA,gBACA,2BACA,aACA,iBACA,mCACA,2BACA,+BACA,mCACA,oCAEH,UAAU,uBAAuB,qBACjC,UAAU,cAAc;QACrB,aAAa;QACb,YAAU,CAAA,YAAA;;;;YAEK,SAFG,WAEF,UAAU,cAAc,QAAQ,QAAQ,OAAO,qBAAqB,SAC5E,gBAAgB,eAAe,OAAO,YAAY;gBAnBlD,gBAAgB,MAgBN;;gBAIV,QAAQ,OAAO,MAAM,EAAC,UAAA,UAAU,cAAA,cAAc,QAAA,QAAQ,QAAA,QAAQ,OAAA,OAAO,qBAAA;oBACjE,SAAA,SAAS,gBAAA,gBAAgB,eAAA,eAAe,OAAA,OAAO,YAAA;;;YAfvD,aAUc,YAAU,CAAA;gBATpB,KAAK;gBACL,OAgBG,SAAA,UAAG;oBAfF,IAAI,QAAQ;;oBAgBhB,KAAK,aAAa,yBACb,KAAK,YAAM;wBACR,MAAK,WAAW;;;eAZzB;gBACC,KAAK;gBACL,OAcG,SAAA,UAAG;oBACN,OAAQ,KAAK,OAAO,QAAQ,KAAK,QAAQ,iBAAiB,KACtD,KAAK,eAAe;;eAbzB;gBACC,KAAK;gBACL,OAcM,SAAA,YAAG;oBACT,OAAO,KAAK,eAAe;;eAZ5B;gBACC,KAAK;gBACL,OAaS,SAAA,gBAAG;oBACZ,OAAO,CAAC,KAAK,aAAa,CAAC,KAAK,eAAe,KAAK,OAAO,cAAc;;eAX1E;gBACC,KAAK;gBACL,OAYG,SAAA,UAAG;oBACN,IAAI,KAAK,aAAa,KAAK,OAAO,QAAQ,SAAS,sBAC/C,KAAK,OAAO,QAAQ,SAAS,kBAAkB;wBAC/C,KAAK,MAAM,KAAK;4BACZ,eAAe;4BACf,aAAa;4BACb,WAAW;4BACX,gBAAgB;4BAChB,iBAAiB;;2BAElB;wBACH,KAAK,SAAS;;;eAVnB;gBACC,KAAK;gBACL,OAYO,SAAA,cAAG;oBACV,IAAI,KAAK,OAAO,QAAQ,SAAS,sBAC7B,KAAK,OAAO,QAAQ,SAAS,kBAAkB;;;wBAG/C,OAAO;2BACJ;wBACH,OAAO;;;eAVZ;gBACC,KAAK;gBACL,OAYO,SAAA,cAAG;oBACV,IAAI,KAAK,WAAW;wBAChB,OAAO;2BACJ,IAAI,KAAK,aAAa;wBACzB,OAAO;2BACJ;wBACH,OAAO;;;eATZ;gBACC,KAAK;gBACL,OAWU,SAAA,iBAAG;oBACb,IAAI,KAAK,WAAW;wBAChB,OAAO;2BACJ,IAAI,KAAK,aAAa;wBACzB,OAAO;2BACJ;wBACH,OAAO;;;eARZ;gBACC,KAAK;gBACL,OAUe,SAAA,sBAAG;oBATd,IAAI,SAAS;;oBAUjB,KAAK,MAAM,KAAK;wBACZ,eAAe;wBACf,aAAa;wBACb,WAAW;wBACX,SAAS;4BACL,UAAU,SAAA,WAAM;gCACZ,IAAI,OAAK,UAAU;oCACf,OAAO,OAAK,oBAAoB;;gCAEpC,OAAO;;4BAEX,UAAU,KAAK;;;oBAGvB,IAAI,OAAO,QAAQ,QAAQ,KAAK,QAAQ,UAAU,KAAK;oBACvD,KAAK,SAAS;;eANf;gBACC,KAAK;gBACL,OAOa,SAAA,oBAAG;oBANZ,IAAI,SAAS;;oBAOjB,IAAI,iBAAc,KAAM,KAAK,OAAO,SAAS,KAAK,OAAO,MAAM;wBAC3D,UAAU,EAAC,iBAAiB;;oBAEhC,KAAK,MAAM,KAAK;wBACZ,eAAe;wBACf,aAAa;wBACb,WAAW;wBACX,iBAAiB;wBACjB,gBAAgB;wBAChB,SAAS;4BACL,gBAAgB,SAAA,iBAAM;gCAClB,OAAO,OAAK,MAAM,IAAI,gBAAgB,SACjC,KAAK,UAAA,QAAU;oCACZ,IAAI,OAAO,OAAO,KAAK;oCACvB,OAAO;wCACH,MAAM,KAAK;wCACX,UAAU,KAAK;wCACf,OAAO,KAAK;wCACZ,OAAO,KAAK;;;;;;;;;YAGxC,OAnHc;;;;IA0HtB,SAAS,oBAAoB,cAAc,QAAQ,YAAY;QAC3D,OAAO;YACH,UAAU;YACV,OAAO;YACP,MAAM,SAAA,KAAU,OAAO,IAAI;gBACvB,IAAM,SAAS;gBACf,IAAM,YAAY;gBAClB,IAAM,aAAa;gBACnB,IAAM,WAAW;gBACjB,IAAI,MAAG;oBAAE,OAAI;oBAAE,YAAS;oBAAE,MAAG;;gBAE7B;;;;gBAIA,SAAS,WAAW;oBAChB,IAAM,OAAO,OAAO,QAAQ,QAAQ;oBACpC,MAAM;oBACN,YAAY,CAAE,KAAK,eAAe,KAAK,aAAc;oBACrD,OAAO,KAAK,WAAW,IAAI;;oBAE3B;;oBAEA,IAAM,UAAU,aAAa,UAAU,IACnC,UAAU,YAAY;wBAClB,IAAM,OAAO,WAAW,KAAK,QAAQ;wBACrC,YAAY,CAAE,KAAK,eAAe,KAAK,aAAc;wBACrD,OAAO,KAAK,WAAW,IAAI;;wBAE3B;;;oBAIR,IAAI,eAAe,WAAW,IAAI,aAAa,YAAM;wBACjD,MAAM;wBACN;;oBAEJ,IAAI,iBAAiB,WAAW,IAAI,WAAW,YAAM;wBACjD,MAAM;wBACN;;;oBAGJ,MAAM,IAAI,YAAY,YAAK;wBACvB;wBACA;wBACA;;;;gBAIR,SAAS,iBAAiB;oBACtB,OAAO,OAAO,SAAS,iBAChB,OAAO,QAAQ,KAAK,WAAW;;;gBAG1C,SAAS,aAAa;oBAClB,IAAI,SAAS,SAAS,MAAM;;oBAE5B,IAAI,CAAC,kBAAkB;wBACnB,SAAS,SAAS,YAAY;;oBAElC,IAAI,WAAW,KAAK;wBAChB,MAAM;wBACN,GAAG,IAAI,eAAe;;;;;;KAMzC","file":"ovpApp/components/header/site-header.js","sourcesContent":["(() => {\n    'use strict';\n\n    angular.module('ovpApp.components.header', [\n        'ovpApp.components.header.toggler',\n        'ovpApp.components.header.data',\n        'ovpApp.components.header.menuItem',\n        'ovpApp.components.ooh',\n        'ovpApp.components.settingsMenu',\n        'ovpApp.remotePlayer.setTopConnection',\n        'ovpApp.messages',\n        'ovpApp.legacy.httpUtil',\n        'ovpApp.search.input',\n        'ovpApp.services.homePage',\n        'ovpApp.services.stbService',\n        'ovpApp.components.mainMenu',\n        'ui.bootstrap',\n        'ui.router',\n        'ovpApp.oauth',\n        'ovpApp.directives.focus',\n        'ngCookies',\n        'ovpApp.config',\n        'ovpApp.components.offCanvasMenu',\n        'ovpApp.components.modal',\n        'ovpApp.customerInfo.service',\n        'ovpApp.components.specu.support',\n        'ovpApp.components.specu.signout'\n    ])\n    .directive('positionUnderHeader', positionUnderHeader)\n    .component('siteHeader', {\n        templateUrl: '/js/ovpApp/components/header/site-header.html',\n        controller: class SiteHeader {\n            /* @ngInject */\n            constructor(httpUtil, OauthService, $state, config, modal, customerInfoService, $window,\n                profileService, OvpSrcService, $http, $rootScope) {\n                angular.extend(this, {httpUtil, OauthService, $state, config, modal, customerInfoService,\n                    $window, profileService, OvpSrcService, $http, $rootScope});\n            }\n\n            $onInit() {\n                this.OauthService.waitUntilAuthenticated()\n                    .then(() => {\n                        this.loggedIn = true;\n                    });\n            }\n\n            isSpecU() {\n                return (this.$state.current.name.indexOf('ovp.specu') === 0) ||\n                    this.profileService.isSpecU();\n            }\n\n            isBulkMDU () {\n                return this.profileService.isBulkMDU();\n            }\n\n            isMenuVisible() {\n                return !this.isSpecU() && !this.isBulkMDU() && this.config.offCanvasMenu.enabled;\n            }\n\n            signOut() {\n                if (this.isSpecU() && this.$state.current.name !== 'ovp.specuwelcome' &&\n                    this.$state.current.name !== 'ovp.specuerror') {\n                    this.modal.open({\n                        showCloseIcon: false,\n                        windowClass: 'specu-page',\n                        component: 'specuSignout',\n                        ariaLabelledBy: 'labelText',\n                        ariaDescribedBy: 'descriptionBlockText'\n                    });\n                } else {\n                    this.httpUtil.logout();\n                }\n            }\n\n            signOutText() {\n                if (this.$state.current.name === 'ovp.specuwelcome' ||\n                    this.$state.current.name === 'ovp.specuerror') {\n                    // In this context, the link indicates they want to sign in with their\n                    //    residential account, so 'sign in' is the desired label\n                    return 'Sign In';\n                } else {\n                    return 'Sign Out';\n                }\n            }\n\n            getLogoPath() {\n                if (this.isSpecU()) {\n                    return 'images/logo-specu-horiz.png';\n                } else if (this.isBulkMDU()) {\n                    return 'images/logo-bulk-mdu-horiz.svg';\n                } else {\n                    return 'images/logo-horiz.png';\n                }\n            }\n\n            getLogoAltText() {\n                if (this.isSpecU()) {\n                    return 'Spectrum U, back to live tv';\n                } else if (this.isBulkMDU()) {\n                    return 'Spectrum Community Solutions, back to live TV';\n                } else {\n                    return 'spectrum tv, back to live tv';\n                }\n            }\n\n            toggleOffCanvasMenu() {\n                this.modal.open({\n                    showCloseIcon: false,\n                    windowClass: 'off-canvas-menu',\n                    component: 'offCanvasMenu',\n                    resolve: {\n                        userName: () => {\n                            if (this.loggedIn) {\n                                return this.customerInfoService.getName();\n                            }\n                            return '';\n                        },\n                        loggedIn: this.loggedIn\n                    }\n                });\n                var body = angular.element(this.$window.document).find('body');\n                body.addClass('off-canvas-scrollbar');\n            }\n\n            openSupportDialog() {\n                let supportInfoUrl = `${this.config.piHost}${this.config.specU.universityInfoUrl}`,\n                    options = {withCredentials: true};\n\n                this.modal.open({\n                    showCloseIcon: false,\n                    windowClass: 'support-info-message',\n                    component: 'supportInfoMessage',\n                    ariaDescribedBy: 'spec-support-info-description',\n                    ariaLabelledBy: 'spec-support-info-title',\n                    resolve: {\n                        universityInfo: () => {\n                            return this.$http.get(supportInfoUrl, options)\n                                .then(result => {\n                                    let info = result.data.metaData;\n                                    return {\n                                        name: info.Title,\n                                        helpdesk: info.SupportName,\n                                        email: info.SupportEmail,\n                                        phone: info.SupportPhone\n                                    };\n                                });\n                        }\n                    }\n                });\n            }\n        }\n    });\n\n    function positionUnderHeader($transitions, $state, $rootScope) {\n        return {\n            restrict: 'A',\n            scope: {},\n            link: function (scope, el) {\n                const header = 66;\n                const easHeight = 84;\n                const menuHeight = 50;\n                const gradient = 30;\n                let eas, menu, subheader, sum;\n\n                activate();\n\n                /////////\n\n                function activate() {\n                    const data = $state.current.data || {};\n                    eas = 0;\n                    subheader = (!data.hideSubMenu && data.subheader) || 0;\n                    menu = data.hideMenu ? 0 : menuHeight;\n\n                    reposition();\n\n                    const dispose = $transitions.onSuccess({},\n                        function (transition) {\n                            const data = transition.to().data || {};\n                            subheader = (!data.hideSubMenu && data.subheader) || 0;\n                            menu = data.hideMenu ? 0 : menuHeight;\n\n                            reposition();\n                        }\n                    );\n\n                    let vpnsListener = $rootScope.$on('VpnsAlert', () => {\n                        eas = easHeight;\n                        reposition();\n                    });\n                    let easEndListener = $rootScope.$on('EAS:end', () => {\n                        eas = 0;\n                        reposition();\n                    });\n\n                    scope.$on('$destroy', ()=> {\n                        dispose();\n                        vpnsListener();\n                        easEndListener();\n                    });\n                }\n\n                function isVideoVisible() {\n                    return $state.includes('ovp.livetv') ||\n                           $state.current.name.startsWith('ovp.ondemand.play');\n                }\n\n                function reposition() {\n                    let newSum = header + eas + menu;\n                    // Overlap video with gradient below header main menu\n                    if (!isVideoVisible()) {\n                        newSum = newSum + subheader + gradient;\n                    }\n                    if (newSum !== sum) {\n                        sum = newSum;\n                        el.css('padding-top', sum);\n                    }\n                }\n            }\n        };\n    }\n})();\n"],"sourceRoot":"/source/"}