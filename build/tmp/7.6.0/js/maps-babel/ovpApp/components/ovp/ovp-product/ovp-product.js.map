{"version":3,"sources":["ovpApp/components/ovp/ovp-product/ovp-product.js"],"names":[],"mappings":"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","file":"ovpApp/components/ovp/ovp-product/ovp-product.js","sourcesContent":["/**\n * ovpProduct\n *\n * Displays the boxart and other simple information about a movie or series.\n *\n * example usage:\n *\n * <ovp-product asset=\"vm.someProgramOrSeriesObject\"></ovp-product>\n *\n * OR, with options:\n *\n * <ovp-product asset=\"vm.someProgram\" options=\"vm.someOptionsObject\"></ovp-product>\n *\n * OR, with options and template:\n *\n * <ovp-product asset=\"vm.someProgram\" options=\"vm.options\" template=\"list\"></ovp-product>\n *\n * Or, in a carousel\n *\n * <ovp-carousel items=\"vm.someArray\">\n *     <ovp-product ng-repeat=\"asset in vm.someArray\" asset=\"asset\"></ovp-product>\n * </ovp-carousel>\n *\n * Bindings:\n *    asset: (object) an event, episode-list, product, or series data delegate; or similar\n *    options: (object) options to modify the behavior. See below\n *    template: (string) specifies which template to use. Valid values = 'boxart' or 'list'.\n *       defaults to 'boxart'\n *    onRemove: (function) callback to be called when an item is removed\n *\n *\n * Options:\n *    enableRemove: (bool) if true, a remove icon will be displayed. defaults to false\n *    showRentalInfo: (bool or string) If true, price information will be displayed (if it\n *       exists). If 'auto', it will decide based on the type of asset. Defaults to 'auto'\n *    enableOOW: (bool) if true, item will be dimmed if flagged as out of window. Defaults\n *       to false\n *\n */\n\n(function () {\n    'use strict';\n\n    const templates = {\n        boxart: '/js/ovpApp/components/ovp/ovp-product/boxart-template.html',\n        list: '/js/ovpApp/components/ovp/ovp-product/list-item-template.html'\n    };\n\n    angular.module('ovpApp.directives.product', [\n        'ovpApp.services.parentalControlsService',\n        'ovpApp.directives.fallbackImage',\n        'ovpApp.directives.fadeinOnload',\n        'ovpApp.directives.lazySrc',\n        'ovpApp.directives.focus'])\n    .component('ovpProduct', {\n        bindings: {\n            asset: '<',\n            options: '<',\n            onRemove: '&?',\n            onClick: '&?',\n            category: '<'\n        },\n        require: {\n            // Some containers have specialized logic, so if we're inside one of them\n            // we need to inherit that code.\n            carouselContainer: '^^?ovpCarousel',\n            gridlistContainer: '^^?ovpGridList'\n        },\n        /* @ngInject */\n        templateUrl: function ($attrs) {\n            return templates[$attrs.template] || templates.boxart;\n        },\n        controller: class OvpProduct {\n            /* @ngInject */\n            constructor(parentalControlsService, $q, $state, $controller, $rootScope, $window, searchFocusIndex,\n                focusMediator) {\n                angular.extend(this, {parentalControlsService, $q, $state, $controller, $rootScope, $window,\n                        searchFocusIndex, focusMediator});\n                let browserName = $window.navigator.userAgent;\n                if (browserName.indexOf('Chrome') !== -1) {\n                    this.isChrome = true;\n                } else {\n                    this.isChrome = false;\n                }\n            }\n\n            $onInit() {\n                this.container = this.carouselContainer || this.gridlistContainer;\n                if (this.options && this.options.focusOnLoad) {\n                    this.focusMediator.requestFocus(this.focusMediator.highPriority)\n                        .then(() => this.focusOnLoad = true);\n                } else {\n                    this.focusOnLoad = false;\n                }\n            }\n\n            $onChanges(changes) {\n                if (changes.options) {\n                    this.applyDefaultOptions(changes.options.currentValue);\n                }\n            }\n\n            click(index) {\n\n                // Analytics. Begin\n                let selectContentData = {\n                    asset: this.asset,\n                    elementIndex: index\n                };\n\n                if (this.$state.current.name.startsWith('ovp.store') ||\n                    (this.$state.current.name.startsWith('ovp.ondemand'))) {\n\n                    selectContentData.navPagePrimaryName = 'curatedCollections';\n                }\n\n                if (this.options && this.options.mylibCatName) {\n                    selectContentData.mylibCatName = this.options.mylibCatName;\n                }\n\n                if (this.carouselContainer && this.carouselContainer.options) {\n                    selectContentData.pageSubSectionName = this.carouselContainer.options.title;\n                } else if (this.gridlistContainer && this.gridlistContainer.options) {\n                    selectContentData.pageSubSectionName = this.gridlistContainer.options.title;\n                }\n\n                if (this.$state.current.name.startsWith('search') && this.asset.resultDisplay) {\n                    selectContentData.generateSelectContent = true;\n                    this.$rootScope.$emit('Analytics:search-select-item', selectContentData);\n                } else {\n                    this.$rootScope.$emit('Analytics:selectContent', selectContentData);\n                }\n                // Analytics. End\n\n                if (this.onClick) {\n                    this.onClick({asset: this.asset, index: index});\n                } else {\n                    let route = this.asset.clickRoute;\n                    if (route && route[0] && route[0].startsWith('search')) {\n                        this.searchFocusIndex.set(this.options.index, this.options.parentIndex);\n                    }\n                    if (route) {\n                        this.$state.go(...route);\n                    }\n                }\n            }\n\n            remove(event) {\n                let callback = this.onRemove || angular.noop;\n                callback({asset: this.asset});\n\n                event.preventDefault();\n                event.stopPropagation();\n            }\n\n            statusOptions() {\n                if (!this.asset) {\n                    return {};\n                }\n\n                let bom = true;\n                if (this.$rootScope.location && !this.$rootScope.location.behindOwnModem) {\n                    bom = false;\n                }\n\n                return {\n                    outOfWindow: this.asset.isOutOfWindow && this.options.enableOOW,\n                    outOfHome: !this.asset.availableOutOfHome && !bom\n                };\n            }\n\n            playedStyle() {\n                if (this.asset && this.asset.bookmark && !this.asset.bookmark.complete) {\n                    return {width: this.asset.playedPct + '%'};\n                } else {\n                    return {};\n                }\n            }\n\n            showRentalInfo() {\n                if (this.options.showRentalInfo == 'auto') {\n                    return this.isTvod();\n                } else {\n                    return this.options.showRentalInfo;\n                }\n            }\n\n            isTvod() {\n                const price = this.asset && this.asset.price;\n                return angular.isDefined(price) && ((angular.isNumber(price) && price > 0) ||\n                        (angular.isString(price) && price.toLowerCase() !== 'free'));\n            }\n\n            tabIndex() {\n                if (this.container && angular.isFunction(this.container.itemTabIndex)) {\n                    return this.container.itemTabIndex(this.asset);\n                } else {\n                    return '0';\n                }\n            }\n\n            hasPagination() {\n                if (this.container && angular.isFunction(this.container.hasPagination)) {\n                    return this.container.hasPagination();\n                } else {\n                    return false;\n                }\n            }\n\n            getTitlePrefix() {\n                let prefix = '';\n                if (this.asset.isBlockedByParentalControls) {\n                    prefix = 'Blocked';\n                }\n                if (this.asset.isEntitled === false) {\n                    prefix = 'Not Entitled';\n                }\n                return prefix;\n            }\n\n            ////////////////////////\n\n            applyDefaultOptions(newOptions) {\n                const defaults = {\n                    enableRemove: false,\n                    enableOOW: false,\n                    showRentalInfo: 'auto'\n                };\n                this.options = angular.extend({}, defaults, newOptions);\n            }\n        }\n    });\n})();\n"],"sourceRoot":"/source/"}