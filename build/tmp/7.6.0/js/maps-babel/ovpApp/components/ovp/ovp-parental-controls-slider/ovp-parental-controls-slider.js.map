{"version":3,"sources":["ovpApp/components/ovp/ovp-parental-controls-slider/ovp-parental-controls-slider.js"],"names":[],"mappings":"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","file":"ovpApp/components/ovp/ovp-parental-controls-slider/ovp-parental-controls-slider.js","sourcesContent":["(function () {\n    'use strict';\n\n    angular.module('ovpApp.components.ovpParentalControlsSlider', ['ovpApp.services.parentalControlsService'])\n    .component('ovpParentalControlsSlider', {\n        bindings: {\n            ratings: '<',\n            currentRating: '=', /*current rating is the highest unblocked rating*/\n            disabled: '<',\n            enableCallback: '<',\n            label: '<'\n        },\n        templateUrl: '/js/ovpApp/components/ovp/ovp-parental-controls-slider/ovp-parental-controls-slider.html',\n        controller: class RatingsSlider {\n            /* @ngInject */\n            constructor($q, $rootScope, parentalControlsService) {\n                angular.extend(this, {$q, $rootScope, parentalControlsService});\n            }\n\n            $onInit() {\n                this.pcDisabled = false;\n                this.updatePcDisabled();\n                this.$rootScope.$on('ParentalControls:updated', this.updatePcDisabled.bind(this));\n            }\n\n            updatePcDisabled() {\n                this.parentalControlsService.isParentalControlsDisabledForClient()\n                    .then(isDisabled => this.pcDisabled = isDisabled);\n            }\n\n            ratingClicked(rating) {\n                if (!this.disabled) {\n                    if (this.getIndexOfRating(this.currentRating) >= this.getIndexOfRating(rating)) {\n                        // user clicked on unblocked rating\n                        // current rating, which is highest unblocked rating, is -1 of rating.\n                        let i = this.getIndexOfRating(rating);\n                        this.currentRating = this.ratings[i - 1] || '';\n                    } else {\n                        // user clicked on blocked\n                        this.currentRating = rating;\n                    }\n                }\n            }\n\n            ratingIsBlocked(testRating) {\n                return this.getIndexOfRating(testRating) > this.getIndexOfRating(this.currentRating);\n            }\n\n            getIndexOfRating(testRating) {\n                if (!testRating) {\n                    return -1;\n                }\n                for (let i = 0; i < this.ratings.length; i++) {\n                    if (testRating === this.ratings[i]) {\n                        return i;\n                    }\n                }\n            }\n\n            currentDescription() {\n                let caveat = '';\n                let tense = 'are';\n                if (this.pcDisabled) {\n                    caveat = ', if you enable parental controls';\n                    tense = 'will be';\n                }\n\n                if (this.currentRating) {\n                    return `${this.currentRating} and lower ${tense} allowed ${caveat}`;\n                } else {\n                    return `all ratings ${tense} blocked ${caveat}`;\n                }\n            }\n\n            onKeydown(event) {\n                if (event.ctrlKey || event.shiftKey || event.altKey) {\n                    return true;\n                }\n\n                const keys = {\n                    end: 35,\n                    home: 36,\n                    left: 37,\n                    up: 38,\n                    down: 39,\n                    right: 40\n                };\n\n                let index = this.getIndexOfRating(this.currentRating);\n\n                if (event.keyCode >= keys.end && event.keyCode <= keys.right) {\n                    event.preventDefault();\n\n                    let enabledPromise;\n                    if (this.disabled) {\n                        enabledPromise = this.enableCallback ?\n                            this.enableCallback() || this.$q.resolve() : this.$q.reject();\n                    } else {\n                        enabledPromise = this.$q.resolve();\n                    }\n\n                    enabledPromise.then(() => {\n                        if (event.keyCode == keys.left || event.keyCode == keys.up) {\n                            this.currentRating = this.ratings[index - 1];\n                        } else if (event.keyCode == keys.right || event.keyCode == keys.down) {\n                            this.currentRating = this.ratings[Math.min(index + 1, this.ratings.length - 1)];\n                        } else if (event.keyCode == keys.home) {\n                            this.currentRating = undefined;\n                        } else if (event.keyCode == keys.end) {\n                            this.currentRating = this.ratings[this.ratings.length - 1];\n                        }\n\n                    });\n                }\n            }\n        }\n    });\n\n}());\n"],"sourceRoot":"/source/"}