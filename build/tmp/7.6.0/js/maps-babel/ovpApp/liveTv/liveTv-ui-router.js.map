{"version":3,"sources":["ovpApp/liveTv/liveTv-ui-router.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,iBAAiB,CAAC,YAAY,EAAE,SAAS,cAAc,KAAK,GAAG,EAAE,IAAI,OAAO,IAAI,IAAI,KAAK,MAAM,IAAI,KAAK,OAAO,IAAI,KAAK,WAAW,IAAI,EAAE,KAAK,IAAI,KAAK,IAAI,OAAO,aAAa,IAAI,EAAE,KAAK,CAAC,KAAK,GAAG,QAAQ,OAAO,KAAK,MAAM,EAAE,KAAK,KAAK,GAAG,QAAQ,IAAI,KAAK,KAAK,WAAW,GAAG,WAAW,OAAO,KAAK,EAAE,KAAK,MAAM,KAAK,eAAe,EAAE,IAAI,EAAE,IAAI,CAAC,MAAM,GAAG,WAAW,GAAG,uBAAuB,EAAE,IAAI,IAAI,MAAM,QAAQ,OAAO,QAAQ,OAAO,UAAU,KAAK,GAAG,EAAE,IAAI,MAAM,QAAQ,MAAM,EAAE,OAAO,YAAY,IAAI,OAAO,YAAY,OAAO,MAAM,EAAE,OAAO,cAAc,KAAK,WAAW,EAAE,MAAM,IAAI,UAAU;;AAFvlB,CAAC,YAAY;IACT;;;;IAEA,QAAQ,OAAO,sBAAsB,CACjC,aACA,mCACA,kBAEH,IAAI,KACJ,OAAO;;;IAGR,SAAS,IAAI,eAAe,UAAU,cAAc,YAAY,QAAQ;;;QAGpE,aAAa,UAAU,EAAC,MAAM,gBAAe,UAAU,YAAY;YAC/D,IAAM,eAAe,WAAW,OAAO,UAAU;YACjD,IAAM,YAAY,aAAa;YAC/B,IAAI,UAAU,KAAK,UAAA,OAAK;gBADpB,OACwB,MAAM,SAAS;gBAAe;gBACtD,cAAc,cACT,KAAK,UAAA,QAAM;oBAAZ,OAAgB,OAAO;;;;;;QAKnC,aAAa,QAAQ,EAAC,IAAI,gBAAe,UAAU,YAAY;YAC3D,IAAM,eAAe,WAAW,OAAO,UAAU;YACjD,IAAM,YAAY,aAAa;YAC/B,IAAI,UAAU,KAAK,UAAA,OAAK;gBAEpB,OAFwB,MAAM,SAAS;gBAAe;gBACtD,cAAc,cACT,KAAK,UAAA,QAAU;oBACZ,OAAO;;oBAEP,WAAW,WAAW,sBAAsB,OAAO;oBACnD,WAAW,WAAW;;;;;;;IAO1C,SAAS,OAAO,gBAAgB,cAAc;QAC1C,IAAM,YAAY;YACd,YAAY;YACZ,MAAM;gBACF,YAAY,aAAa;gBACzB,WAAW;gBACX,WAAW,SAAA,UAAU,YAAY;oBAC7B,OAAO,WAAW,WAAW,IAAI,cAC5B,mBAAmB,wBACnB,IAAI,UAAC,MAAc;wBACpB,IAAI,QAAQ,eADN,MAAc;;wBAGpB,IAHO,QAAK,MAAA;wBAIZ,IAJc,QAAK,MAAA;wBAKnB,OAL4B,MAAM,QAAK,OAAK,MAAM,QAAQ,WAAQ;uBACjE,UAAU;;gBAEnB,oBAAoB;;YAExB,SAAS;;gBAEL,8CAAkB,SAAA,iBAAU,yBAAyB;oBACjD,OAAO,wBAAwB;;;gBAGnC,8BAAU,SAAA,SAAU,iBAAiB;oBACjC,OAAO,gBAAgB;;;YAG/B,QAAQ;gBACJ,QAAQ;;YAEZ,OAAO;gBACH,SAAS;;oBAEL,YAAY;;;;YAIpB,yCAAS,SAAA,QAAU,YAAY,eAAe;gBAC1C,cAAc;;;YAGlB,wCAAQ,SAAA,OAAU,YAAY,eAAe;gBACzC,cAAc;;;;QAItB,eAAe,MAAM,cACjB,QAAQ,OAAO;YACX,KAAK;WACN;;QAEP,SAAS,gBAAgB,YAAY;YACjC,IAAM,kBAAkB,WAAW,WAAW,IAAI;YAClD,OAAO,gBAAgB,cAClB,KAAK,UAAA,UAAY;gBACd,IAAI,CAAC,SAAS,MAAM;oBAChB,OAAO;;;;;KAK1B","file":"ovpApp/liveTv/liveTv-ui-router.js","sourcesContent":["(function () {\n    'use strict';\n\n    angular.module('ovpApp.live.router', [\n        'ui.router',\n        'ovpApp.services.locationService',\n        'ovpApp.player'\n        ])\n    .run(run)\n    .config(config);\n\n    /* @ngInject */\n    function run(playerService, $timeout, $transitions, $rootScope, $state) {\n        // This would be better in an onInactivate, but stickyState's onInactivate hooks\n        //    appear to be nonfunctional in the current version\n        $transitions.onSuccess({from: 'ovp.livetv'}, function (transition) {\n            const stickyStates = transition.router.getPlugin('stickystates');\n            const inactives = stickyStates.inactives();\n            if (inactives.find(state => state.name === 'ovp.livetv')) {\n                playerService.getInstance()\n                    .then(player => player.pause());\n            }\n        });\n\n        // And this would be better in onReactivate\n        $transitions.onStart({to: 'ovp.livetv'}, function (transition) {\n            const stickyStates = transition.router.getPlugin('stickystates');\n            const inactives = stickyStates.inactives();\n            if (inactives.find(state => state.name === 'ovp.livetv')) {\n                playerService.getInstance()\n                    .then(player => {\n                        player.play();\n                        // Player resuming, so complete pageView and acknowledge resumed playback.\n                        $rootScope.$broadcast('pageChangeComplete', $state.current);\n                        $rootScope.$broadcast('playback-resumed');\n                    });\n            }\n        });\n    }\n\n    /* @ngInject */\n    function config($stateProvider, CAPABILITIES) {\n        const liveState = {\n            redirectTo: restrictOutOfUs,\n            data: {\n                capability: CAPABILITIES.LIVE,\n                bodyClass: 'live-page video-player-page',\n                pageTitle: function (transition) {\n                    return transition.injector().get('$rootScope')\n                        .$eventToObservable('player:assetSelected')\n                        .map(([event, asset]) => `${asset.title}, ${asset.channel.callSign}, Live TV`)\n                        .startWith('Live TV');\n                },\n                hideHeaderGradient: true\n            },\n            resolve: {\n                /* @ngInject */\n                parentalControls: function (parentalControlsService) {\n                    return parentalControlsService.getParentalControlsForUser();\n                },\n                /* @ngInject */\n                location: function (locationService) {\n                    return locationService.getLocation();\n                }\n            },\n            params: {\n                eanUrl: null\n            },\n            views: {\n                appView: {\n                    /* @ngInject */\n                    controller: 'LiveController as vm'\n                }\n            },\n            /* @ngInject */\n            onEnter: function ($rootScope, playerService) {\n                playerService.stop();\n            },\n            /* @ngInject */\n            onExit: function ($rootScope, playerService) {\n                playerService.stop();\n            }\n        };\n\n        $stateProvider.state('ovp.livetv',\n            angular.extend({\n                url: '/livetv?tmsid&testEanUrl'\n            }, liveState));\n\n        function restrictOutOfUs(transition) {\n            const locationService = transition.injector().get('locationService');\n            return locationService.getLocation()\n                .then(location => {\n                    if (!location.inUS) {\n                        return 'ovp.outOfUs';\n                    }\n                });\n        }\n    }\n}());\n"],"sourceRoot":"/source/"}