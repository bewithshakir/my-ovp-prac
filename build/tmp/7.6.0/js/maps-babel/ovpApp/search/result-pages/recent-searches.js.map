{"version":3,"sources":["ovpApp/search/result-pages/recent-searches.js"],"names":[],"mappings":"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","file":"ovpApp/search/result-pages/recent-searches.js","sourcesContent":["(() => {\n    'use strict';\n    angular.module('ovpApp.search.recentSearches', [\n        'ovpApp.search.searchService',\n        'ovpApp.filters.titleCase',\n        'ui.router'\n        ])\n        .component('recentSearches', {\n            templateUrl: '/js/ovpApp/search/result-pages/recent-searches.html',\n            bindings: {},\n            controller: class RecentSearchesController {\n                /* @ngInject */\n                constructor(searchService, $state, $rootScope) {\n                    this.$state = $state;\n                    this.$rootScope = $rootScope;\n                    this.searchService = searchService;\n                }\n\n                $onInit() {\n                    this.activeIndex = -1;\n                    this.recentSearches = [...this.searchService.getRecentSearches()];\n\n                    this.$rootScope.$broadcast('pageChangeComplete', this.$state.current);\n                }\n\n                onKey(event) {\n                    event.preventDefault();\n                    if (event.keyCode == 38) {\n                        // up\n                        if (this.activeIndex === -1) {\n                            this.selectRecent(this.recentSearches.length - 1);\n                        } else {\n                            this.selectRecent(Math.max(0, this.activeIndex - 1));\n                        }\n\n                    } else if (event.keyCode == 40) {\n                        // down\n                        if (this.activeIndex + 1 >= this.recentSearches.length) {\n                            this.activeIndex = -1;\n                            angular.element('.search-clear').focus();\n                        } else if (this.activeIndex === -1) {\n                            angular.noop();\n                        } else {\n                            this.selectRecent(Math.min(this.recentSearches.length - 1, this.activeIndex + 1));\n                        }\n\n                    } else if (event.keyCode == 13) {\n                        // enter\n                        if (this.activeIndex >= 0) {\n                            this.click(this.recentSearches[this.activeIndex]);\n                        } else if (this.activeIndex === -1) {\n                            this.clear();\n                        }\n                    } else if (event.keyCode == 9) {\n                        // tab\n                        this.activeIndex = -1;\n                    }\n                }\n\n                isActiveElement(index) {\n                    return index === this.activeIndex;\n                }\n\n                selectRecent(index) {\n                    this.activeIndex = index;\n                }\n\n                click(recent) {\n                    let promise = this.$state.go('search.results', {query: recent,\n                        focusOnLoad: true, isRecentSearch: true});\n                    this.showLoading(promise);\n                    this.searchService.saveRecentSearch(recent); // to move it to the top of the list\n                }\n\n                clear() {\n                    this.recentSearches = [];\n                    this.searchService.clearRecentSearches();\n                    angular.element('input#query').focus();\n                }\n\n                showLoading(promise) {\n                    this.recentSearches = [];\n                    this.$rootScope.$broadcast(\n                        'message:loading',\n                        promise,\n                        'Recent Searches'\n                    );\n                }\n            }\n        });\n})();\n"],"sourceRoot":"/source/"}